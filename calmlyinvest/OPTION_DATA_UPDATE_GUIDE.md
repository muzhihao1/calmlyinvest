# æœŸæƒæ•°æ®æ›´æ–°æŒ‡å—

## ğŸ“Š å…³äºæœŸæƒæ•°æ®æ˜¾ç¤º

### å½“å‰æ•°æ®æ¥æº
- **API**: Market Data APIï¼ˆå®æ—¶å¸‚åœºæ•°æ®ï¼‰
- **æ›´æ–°æ–¹å¼**: ç‚¹å‡»"åˆ·æ–°æ•°æ®"æŒ‰é’®æ‰‹åŠ¨æ›´æ–°
- **è‡ªåŠ¨åˆ·æ–°**: æ¯5åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡ï¼ˆé™é»˜æ¨¡å¼ï¼‰

### æ•°æ®å­—æ®µè¯´æ˜

| å­—æ®µ | è¯´æ˜ | æ¥æº |
|------|------|------|
| **æˆæœ¬ä»·** | æ‚¨ä¹°å…¥/å–å‡ºçš„ä»·æ ¼ | ç”¨æˆ·è¾“å…¥ |
| **å½“å‰ä»·** | å¸‚åœºå®æ—¶æŠ¥ä»· | Market Data API |
| **Delta** | æœŸæƒä»·æ ¼å¯¹æ ‡çš„ä»·æ ¼çš„æ•æ„Ÿåº¦ | Market Data API |
| **æœªå®ç°ç›ˆäº** | å½“å‰æŒä»“ç›ˆäºï¼ˆè€ƒè™‘åˆçº¦æ•°å’Œæ–¹å‘ï¼‰ | è®¡ç®—å¾—å‡º |

## ğŸ”„ å¦‚ä½•åˆ·æ–°æœŸæƒæ•°æ®

### æ–¹æ³•1ï¼šæ‰‹åŠ¨åˆ·æ–°ï¼ˆæ¨èï¼‰
1. è¿›å…¥ä»ªè¡¨æ¿
2. ç‚¹å‡»å³ä¸Šè§’çš„**"åˆ·æ–°æ•°æ®"**æŒ‰é’®ï¼ˆğŸ”„å›¾æ ‡ï¼‰
3. ç­‰å¾…2-5ç§’ï¼Œæ‰€æœ‰æœŸæƒä»·æ ¼å’ŒDeltaå°†æ›´æ–°

### æ–¹æ³•2ï¼šè‡ªåŠ¨åˆ·æ–°
- ç³»ç»Ÿæ¯5åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡
- æ— éœ€æ‰‹åŠ¨æ“ä½œ
- åå°é™é»˜æ›´æ–°

## ğŸ’° æœªå®ç°ç›ˆäºè®¡ç®—å…¬å¼

```
æœªå®ç°ç›ˆäº = (å½“å‰ä»· - æˆæœ¬ä»·) Ã— åˆçº¦æ•° Ã— 100 Ã— æ–¹å‘ç³»æ•°

æ–¹å‘ç³»æ•°ï¼š
- ä¹°å…¥(BUY)ï¼š+1ï¼ˆä»·æ ¼ä¸Šæ¶¨=ç›ˆåˆ©ï¼‰
- å–å‡º(SELL)ï¼š-1ï¼ˆä»·æ ¼ä¸‹è·Œ=ç›ˆåˆ©ï¼‰
```

### ç¤ºä¾‹è®¡ç®—

**ä¾‹1: ä¹°å…¥çœ‹è·ŒæœŸæƒ(BUY PUT)**
- æˆæœ¬ä»·ï¼š$11.59
- å½“å‰ä»·ï¼š$5.28ï¼ˆMarket Data APIå®æ—¶æ•°æ®ï¼‰
- åˆçº¦æ•°ï¼š1
- æ–¹å‘ï¼šBUY (+1)

```
ç›ˆäº = ($5.28 - $11.59) Ã— 1 Ã— 100 Ã— 1
     = -$6.31 Ã— 100
     = -$631.00ï¼ˆäºæŸï¼‰
```

**ä¾‹2: å–å‡ºçœ‹æ¶¨æœŸæƒ(SELL CALL)**
- æˆæœ¬ä»·ï¼š$10.00
- å½“å‰ä»·ï¼š$7.00
- åˆçº¦æ•°ï¼š2
- æ–¹å‘ï¼šSELL (-1)

```
ç›ˆäº = ($7.00 - $10.00) Ã— 2 Ã— 100 Ã— (-1)
     = -$3.00 Ã— 200 Ã— (-1)
     = +$600.00ï¼ˆç›ˆåˆ©ï¼Œå› ä¸ºå–å‡ºæœŸæƒä»·æ ¼ä¸‹è·Œæ˜¯å¥½äº‹ï¼‰
```

## ğŸ“ˆ Deltaå€¼è¯´æ˜

### Deltaçš„å«ä¹‰
- **çœ‹æ¶¨æœŸæƒ(CALL)**: Deltaä¸ºæ­£å€¼ï¼ˆ0åˆ°+1ï¼‰
  - Delta = 0.60 è¡¨ç¤ºæ ‡çš„ä¸Šæ¶¨$1ï¼ŒæœŸæƒä»·æ ¼çº¦ä¸Šæ¶¨$0.60

- **çœ‹è·ŒæœŸæƒ(PUT)**: Deltaä¸ºè´Ÿå€¼ï¼ˆ-1åˆ°0ï¼‰
  - Delta = -0.41 è¡¨ç¤ºæ ‡çš„ä¸Šæ¶¨$1ï¼ŒæœŸæƒä»·æ ¼çº¦ä¸‹è·Œ$0.41

### ä¸IBçš„å·®å¼‚
æ‚¨å¯èƒ½æ³¨æ„åˆ°IBæ˜¾ç¤ºçš„Deltaå€¼ä¸æˆ‘ä»¬çš„ä¸åŒï¼š

| å¹³å° | Deltaæ˜¾ç¤º | è¯´æ˜ |
|------|----------|------|
| **IB (Interactive Brokers)** | 0.374 | å¯èƒ½æ˜¾ç¤ºç»å¯¹å€¼ |
| **CalmlyInvest** | -0.4120 | æ ‡å‡†Deltaï¼ˆPUTä¸ºè´Ÿï¼‰ |
| **å·®å¼‚åŸå› ** | IBå¯èƒ½çœç•¥è´Ÿå· | ä¸¤è€…æ•°å€¼æ¥è¿‘ï¼Œéƒ½æ˜¯æ­£ç¡®çš„ |

**æ³¨æ„**: PUTæœŸæƒçš„Deltaåœ¨é‡‘èç†è®ºä¸­åº”è¯¥æ˜¯è´Ÿæ•°ï¼Œè¿™æ˜¯æ ‡å‡†è¡¨ç¤ºæ–¹æ³•ã€‚

## ğŸ” æ•°æ®éªŒè¯

### å¦‚ä½•ç¡®è®¤æ•°æ®æ˜¯æœ€æ–°çš„ï¼Ÿ

1. **æŸ¥çœ‹"å½“å‰ä»·"é¢œè‰²**ï¼š
   - ğŸŸ¢ ç»¿è‰²ï¼šä»·æ ¼ä¸Šæ¶¨
   - ğŸ”´ çº¢è‰²ï¼šä»·æ ¼ä¸‹è·Œ
   - âšª ç™½è‰²ï¼šä»·æ ¼æœªå˜åŒ–

2. **æ£€æŸ¥æœ€åæ›´æ–°æ—¶é—´**ï¼š
   - æŸ¥çœ‹ä»ªè¡¨æ¿é¡¶éƒ¨çš„æ—¶é—´æˆ³
   - æˆ–è€…æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—

3. **å¯¹æ¯”å¤–éƒ¨æ•°æ®**ï¼š
   - ä¸IBã€Tradierç­‰å¹³å°å¯¹æ¯”
   - å…è®¸Â±5%çš„å·®å¼‚ï¼ˆä¸åŒæ•°æ®æºçš„bid-ask spreadï¼‰

### æ•°æ®ä¸å‡†ç¡®ï¼Ÿ

å¦‚æœå‘ç°æ•°æ®ä¸å®é™…å·®å¼‚è¾ƒå¤§ï¼š

1. **ç‚¹å‡»"åˆ·æ–°æ•°æ®"æŒ‰é’®**
   - å¼ºåˆ¶ä»APIé‡æ–°è·å–æœ€æ–°æ•°æ®

2. **æ£€æŸ¥æœŸæƒä»£ç æ ¼å¼**ï¼š
   ```
   æ­£ç¡®: MSFT 251010P515
   é”™è¯¯: MSFT251010P515 (ç¼ºå°‘ç©ºæ ¼)
   ```

3. **ç¡®è®¤æœŸæƒæœªè¿‡æœŸ**ï¼š
   - è¿‡æœŸæœŸæƒæ— æ³•è·å–å®æ—¶æŠ¥ä»·
   - ç³»ç»Ÿä¼šæ˜¾ç¤º"å·²è¿‡æœŸ"æ ‡è®°

4. **æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯**ï¼š
   - æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·
   - æŸ¥çœ‹Consoleæ ‡ç­¾ä¸­çš„é”™è¯¯ä¿¡æ¯

## ğŸ› å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆå½“å‰ä»·æ˜¾ç¤ºçš„æ˜¯æ—§æ•°æ®ï¼Ÿ
**A**: éœ€è¦æ‰‹åŠ¨ç‚¹å‡»"åˆ·æ–°æ•°æ®"æŒ‰é’®ï¼Œæˆ–ç­‰å¾…5åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°ã€‚

### Q2: PUTæœŸæƒçš„Deltaä¸ºä»€ä¹ˆæ˜¯è´Ÿæ•°ï¼Ÿ
**A**: è¿™æ˜¯æ ‡å‡†é‡‘èè¡¨ç¤ºæ–¹æ³•ã€‚PUTæœŸæƒä¸æ ‡çš„ä»·æ ¼åå‘å˜åŠ¨ï¼Œå› æ­¤Deltaä¸ºè´Ÿã€‚

### Q3: æœªå®ç°ç›ˆäºä¸ºä»€ä¹ˆæ˜¯è´Ÿæ•°ï¼ˆæˆ‘æ˜æ˜èµšé’±äº†ï¼‰ï¼Ÿ
**A**:
- **ä¹°å…¥(BUY)**: å½“å‰ä»· > æˆæœ¬ä»· = ç›ˆåˆ©
- **å–å‡º(SELL)**: å½“å‰ä»· < æˆæœ¬ä»· = ç›ˆåˆ©ï¼ˆå…¬å¼ä¼šè‡ªåŠ¨è€ƒè™‘æ–¹å‘ï¼‰

### Q4: Market Data APIçš„æ•°æ®å‡†ç¡®å—ï¼Ÿ
**A**:
- Market Data APIæä¾›å®æ—¶å¸‚åœºæ•°æ®
- ä½¿ç”¨mid priceï¼ˆä¹°ä»·å’Œå–ä»·çš„ä¸­é—´å€¼ï¼‰
- ä¸IBç­‰å¹³å°æ•°æ®é«˜åº¦ä¸€è‡´
- å…è®¸Â±2-5%çš„æ­£å¸¸å·®å¼‚

### Q5: åˆ·æ–°æ•°æ®éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ
**A**:
- å•ä¸ªæœŸæƒï¼š~1-2ç§’
- å¤šä¸ªæœŸæƒï¼šæ¯ä¸ª1-2ç§’ï¼ˆé¡ºåºè¯·æ±‚ï¼‰
- APIæœ‰é€Ÿç‡é™åˆ¶ï¼ˆå…è´¹è¯•ç”¨ç‰ˆï¼‰

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### APIè°ƒç”¨æµç¨‹
1. ç”¨æˆ·ç‚¹å‡»"åˆ·æ–°æ•°æ®"
2. å‰ç«¯å‘é€POSTè¯·æ±‚åˆ° `/api/portfolio/{portfolioId}/refresh-prices`
3. åç«¯è°ƒç”¨Market Data APIè·å–æœ€æ–°æŠ¥ä»·
4. æ›´æ–°æ•°æ®åº“ä¸­çš„`currentPrice`å’Œ`deltaValue`å­—æ®µ
5. å‰ç«¯é‡æ–°è·å–æ•°æ®å¹¶æ›´æ–°UI

### æ•°æ®æ›´æ–°å‡½æ•°
```typescript
// server/market-data.ts
export async function updateOptionPrices(holdings: OptionHolding[]) {
  const marketData = new MarketDataProvider();

  return await Promise.all(
    holdings.map(async holding => {
      const quote = await marketData.getOptionQuote(holding.optionSymbol);
      return {
        ...holding,
        currentPrice: quote.price.toFixed(2),
        deltaValue: quote.delta.toFixed(4)
      };
    })
  );
}
```

## ğŸ¯ ä¸‹ä¸€æ­¥

1. âœ… æ·»åŠ äº†"æœªå®ç°ç›ˆäº"åˆ—
2. âœ… å®æ—¶æ›´æ–°ä»·æ ¼å’ŒDelta
3. ğŸ”„ å»ºè®®ï¼šæ·»åŠ "æœ€åæ›´æ–°æ—¶é—´"æ˜¾ç¤º
4. ğŸ”„ å»ºè®®ï¼šæ·»åŠ "è‡ªåŠ¨åˆ·æ–°"å¼€å…³

---

**æœ‰é—®é¢˜ï¼Ÿ**
- æŸ¥çœ‹Market Data APIæ–‡æ¡£ï¼šhttps://www.marketdata.app/docs/api/options
- æŸ¥çœ‹é¡¹ç›®READMEï¼šMARKETDATA_SETUP_GUIDE.md
